# Nome do seu workflow (aparecerá na aba "Actions" do GitHub)
name: CI - Testes de API com Maven

# Define os "gatilhos" (triggers)
on:
  # Executa quando houver um push para a branch "main"
  push:
    branches: [ "main" ]
  # Executa quando abrirem um Pull Request para a branch "main"
  pull_request:
    branches: [ "main" ]

# Define os "trabalhos" (jobs) que serão executados
jobs:
  # Nosso único trabalho será o de construir e testar
  build-and-test:
    
    # [1] Define a máquina virtual que executará o teste
    # Usaremos a versão mais recente do Ubuntu (Linux)
    runs-on: ubuntu-latest

    # [2] Define os passos (steps) que o job executará
    steps:
      # Passo 1: Baixa o seu código do repositório para a máquina virtual
      - name: Checkout do código
        uses: actions/checkout@v4

      # Passo 2: Configura o ambiente Java (JDK)
      # Usaremos o Java 17, pois foi o que definimos no pom.xml
      - name: Configurar o JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          # Otimização: Habilita o cache do Maven para builds futuros
          cache: 'maven'

      # Passo 3: Executa os testes
      # Este é o mesmo comando que você usa localmente!
      - name: Executar os testes com Maven
        run: mvn test